<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Multi-User PDF Chatbot</title>
    <link rel="stylesheet" href="dashboard-styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">ü§ñ ChatBot AI</div>
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">U</div>
                <div class="user-details">
                    <h3 id="userName">Loading...</h3>
                    <p id="userEmail">Loading...</p>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <h1 class="page-title">Dashboard</h1>
        <p class="page-subtitle">Manage your documents and AI assistant</p>

        <!-- Alert -->
        <div id="alert" class="alert"></div>

        <!-- Stats Grid -->
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card primary">
                <h3>AI Status</h3>
                <div class="value" id="aiStatus">Checking...</div>
                <div class="label">Personal Assistant</div>
            </div>
            <div class="stat-card">
                <h3>Documents</h3>
                <div class="value" id="docCount">0</div>
                <div class="label">PDF Files Uploaded</div>
            </div>
            <div class="stat-card">
                <h3>Knowledge Base</h3>
                <div class="value" id="chunkCount">0</div>
                <div class="label">Text Chunks</div>
            </div>
            <div class="stat-card">
                <h3>Storage Used</h3>
                <div class="value" id="storageUsed">0 MB</div>
                <div class="label">Vector Database</div>
            </div>
        </div>

        <!-- Upload Section -->
        <section class="upload-section">
            <h2 class="section-title">üì§ Upload Documents</h2>
            <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">üìÑ</div>
                <div class="upload-text">Drop PDF files here or click to browse</div>
                <div class="upload-subtext">Supported format: PDF (max 10MB each)</div>
                <button class="upload-button" id="uploadButton" type="button">
                    <span class="text">Choose Files</span>
                    <span class="loading" style="display: none;">
                        <span class="spinner"></span>
                        Uploading...
                    </span>
                </button>
                <input type="file" id="fileInput" class="file-input" accept=".pdf" multiple>
                <div id="uploadProgress" class="progress-bar" style="display: none;">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
            </div>
        </section>

        <!-- Documents Section -->
        <section class="documents-section">
            <div class="documents-header">
                <h2 class="section-title">üìÅ My Documents</h2>
                <div style="display: flex; gap: 12px;">
                    <button class="widget-btn" onclick="openWidgetModal()" id="widgetBtn">
                        üîó Get Widget Code
                    </button>
                    <button class="clear-all-btn" onclick="confirmClearAll()" id="clearAllBtn">
                        üóëÔ∏è Clear All
                    </button>
                </div>
            </div>
            <div id="documentsContainer">
                <div class="empty-state">
                    <div class="empty-icon">üìÇ</div>
                    <div class="empty-title">No documents uploaded yet</div>
                    <div class="empty-text">Upload your first PDF to start building your knowledge base</div>
                </div>
            </div>
        </section>
    </main>

    <!-- Widget Modal -->
    <div id="widgetModal" class="modal">
        <div class="modal-content widget-modal-content">
            <div class="widget-modal-header">
                <h3>üîó Widget Code Generator</h3>
                <button class="chat-close" onclick="closeWidgetModal()">‚úï</button>
            </div>
            
            <div class="widget-config">
                <h4>Configuration</h4>
                <div class="config-grid">
                    <div class="config-item">
                        <label for="widgetTitle">Title</label>
                        <input type="text" id="widgetTitle" class="config-input" value="Need Help?" onchange="updatePreview()">
                    </div>
                    <div class="config-item">
                        <label for="widgetSubtitle">Subtitle</label>
                        <input type="text" id="widgetSubtitle" class="config-input" value="Ask me anything!" onchange="updatePreview()">
                    </div>
                    <div class="config-item">
                        <label for="widgetLogoUrl">Logo URL</label>
                        <input type="url" id="widgetLogoUrl" class="config-input" value="https://via.placeholder.com/32" onchange="updatePreview()">
                    </div>
                    <div class="config-item">
                        <label for="widgetPosition">Position</label>
                        <select id="widgetPosition" class="config-input" onchange="updatePreview()">
                            <option value="bottom-right">Bottom Right</option>
                            <option value="bottom-left">Bottom Left</option>
                            <option value="top-right">Top Right</option>
                            <option value="top-left">Top Left</option>
                        </select>
                    </div>
                    <div class="config-item">
                        <label for="widgetWidth">Width (px)</label>
                        <input type="number" id="widgetWidth" class="config-input" value="400" min="300" max="600" onchange="updatePreview()">
                    </div>
                    <div class="config-item">
                        <label for="widgetHeight">Height (px)</label>
                        <input type="number" id="widgetHeight" class="config-input" value="500" min="400" max="700" onchange="updatePreview()">
                    </div>
                    <div class="config-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="widgetShowClose" checked onchange="updatePreview()">
                            Show close button
                        </label>
                    </div>
                </div>
            </div>

            <div class="widget-preview">
                <h4>Preview</h4>
                <div class="preview-container">
                    <div class="mock-website">
                        <div class="mock-header">Your Website</div>
                        <div class="mock-content">This is how the widget will appear on your website...</div>
                        
                        <div id="previewFrame" class="widget-preview-frame">
                            <div class="preview-widget">
                                <div class="preview-header">
                                    <img id="previewLogo" class="preview-logo" src="https://via.placeholder.com/32" alt="Logo">
                                    <div class="preview-text">
                                        <div id="previewTitle" class="preview-title">Need Help?</div>
                                        <div id="previewSubtitle" class="preview-subtitle">Ask me anything!</div>
                                    </div>
                                    <button id="previewClose" class="preview-close">‚úï</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="code-sections">
                <div class="code-section">
                    <div class="code-header">
                        <h4>HTML/React Code</h4>
                        <button class="copy-btn" onclick="copyCode('htmlCode')">Copy</button>
                    </div>
                    <textarea id="htmlCode" class="code-textarea" readonly></textarea>
                </div>

                <div class="code-section">
                    <div class="code-header">
                        <h4>Script Tag</h4>
                        <button class="copy-btn" onclick="copyCode('scriptCode')">Copy</button>
                    </div>
                    <textarea id="scriptCode" class="code-textarea" readonly></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Copy Toast -->
    <div id="copyToast" class="copy-toast">
        <div class="toast-content">
            <span class="toast-icon">‚úì</span>
            <span class="toast-text">Code copied to clipboard!</span>
        </div>
    </div>

    <!-- Chat Button -->
    <button class="chat-button" onclick="openChat()" title="Chat with AI" id="chatButton">
        üí¨
    </button>

    <!-- Chat Overlay -->
    <div id="chatOverlay" class="chat-overlay">
        <div class="chat-container">
            <div class="chat-header">
                <h3>
                    ü§ñ Chat with your documents
                </h3>
                <button class="chat-close" onclick="closeChat()">‚úï</button>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="chat-empty">
                    <div class="chat-empty-icon">üí¨</div>
                    <div class="chat-empty-title">Start a conversation</div>
                    <div class="chat-empty-text">Ask questions about your uploaded documents</div>
                </div>
            </div>
            <div class="chat-input-area">
                <div class="chat-input-container">
                    <textarea 
                        id="chatInput" 
                        class="chat-input" 
                        placeholder="Type your question here..."
                        rows="1"></textarea>
                    <button id="chatSend" class="chat-send" onclick="sendMessage()">
                        <span class="text">Send</span>
                        <span class="loading" style="display: none;">
                            <span class="spinner"></span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3 class="modal-title" id="modalTitle">Confirm Action</h3>
            <p class="modal-text" id="modalText">Are you sure you want to proceed?</p>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closeModal()" id="cancelBtn">Cancel</button>
                <button class="modal-btn primary" id="confirmBtn">
                    <span class="btn-text">Confirm</span>
                    <span class="loading" style="display: none;">
                        <span class="spinner"></span>
                        Processing...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- External JavaScript -->
    <script src="dashboard.js"></script>
</body>
</html>